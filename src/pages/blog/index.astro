---
import Base from '../../layouts/Base.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('posts', ({ data }) => !data.draft))
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<Base title="Blog | Remoun" description="Hacks, scripts, and things I've found useful.">
  <h1>Blog</h1>
  <p class="page-intro">Documenting hacks, scripts, and things I've found useful.</p>

  <ul class="post-list">
    {posts.map(post => (
      <li class="post-item">
        <h2 class="post-item__title">
          <a href={`/blog/${post.slug}`}>{post.data.title}</a>
        </h2>
        <p class="post-item__meta">
          <time datetime={post.data.date.toISOString()}>
            {post.data.date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}
          </time>
        </p>
        <p class="post-item__description">{post.data.description}</p>
        {post.data.tags.length > 0 && (
          <div class="tags">
            {post.data.tags.map(tag => (
              <span class="tag">{tag}</span>
            ))}
          </div>
        )}
      </li>
    ))}
  </ul>

  {posts.length === 0 && (
    <p class="empty-state">No posts yet. Check back soon!</p>
  )}
</Base>

<style>
  .page-intro {
    color: var(--text-secondary);
    margin-bottom: 2rem;
  }

  .empty-state {
    color: var(--text-secondary);
    font-style: italic;
  }
</style>
